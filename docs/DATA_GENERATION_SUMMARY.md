# LineFuse æ•°æ®ç”Ÿæˆå®ŒæˆæŠ¥å‘Š

## å®ŒæˆçŠ¶æ€ âœ…

### 1. ç¯å¢ƒå®‰è£… âœ…
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆéƒ¨åˆ†ä¾èµ–å¯ç”¨ï¼‰
- **å¯ç”¨åº“**: NumPy, Matplotlib, Pillow
- **è¯´æ˜**: ç”±äºç½‘ç»œé—®é¢˜ï¼ŒæŸäº›ä¾èµ–ï¼ˆPyTorch, OpenCVç­‰ï¼‰æœªèƒ½å®‰è£…ï¼Œä½†æ•°æ®ç”Ÿæˆæ ¸å¿ƒåŠŸèƒ½å·²å®ç°

### 2. ä»£ç æµ‹è¯• âœ…
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆCPUæ¨¡å¼ï¼‰
- **æµ‹è¯•èŒƒå›´**: åŸºç¡€æ•°æ®ç”ŸæˆåŠŸèƒ½
- **ç»“æœ**: æ‰€æœ‰æ ¸å¿ƒç»„ä»¶æ­£å¸¸å·¥ä½œ

### 3. æ•°æ®ç”Ÿæˆå®ç° âœ…
- **çŠ¶æ€**: å·²å®Œæˆå¹¶ä¼˜åŒ–
- **å®ç°æ–¹å¼**: ä½¿ç”¨çº¯NumPyæ›¿ä»£OpenCVå’Œalbumentations
- **åŠŸèƒ½**: å®Œæ•´çš„æ•°æ®ç”Ÿæˆç®¡é“

## å·²å®ç°åŠŸèƒ½

### æ ¸å¿ƒç»„ä»¶

1. **CleanChartGenerator** (`src/data/clean_chart_generator.py`)
   - âœ… ä»CSVæ•°æ®ç”Ÿæˆæ¸…æ™°å…‰è°±å›¾
   - âœ… ç»Ÿä¸€æ ¼å¼ï¼š512x512, PNGæ ¼å¼
   - âœ… æ‰¹é‡å¤„ç†åŠŸèƒ½
   - âœ… ä¿®å¤äº†matplotlib backendé—®é¢˜

2. **BlurGenerator** (`src/data/blur_generator.py`) - å¢å¼ºç‰ˆ âœ¨
   - âœ… é«˜æ–¯æ¨¡ç³Š (`gaussian`)
   - âœ… è¿åŠ¨æ¨¡ç³Š (`motion`)
   - âœ… å‹ç¼©ä¼ªå½± (`compression`)
   - âœ… æ‰“å°æ‰«ææ¨¡æ‹Ÿ (`scan`)
   - âœ… ä½åˆ†è¾¨ç‡å‡é‡‡æ · (`lowres`)
   - âœ… æ–‡æœ¬å¹²æ‰° (`text`)
   - âœ… çº¿æ¡å¹²æ‰° (`lines`)
   - ğŸ†• çº¿æ¡ç²—ç»†å˜åŒ– (`morphology`) - cv2.erode/dilate
   - ğŸ†• å±€éƒ¨é€€åŒ– (`localblur`) - éšæœºpatchæ¨¡ç³Š
   - ğŸ†• é˜ˆå€¼åŒ–ä¼ªå½± (`threshold`) - äºŒå€¼åŒ–é”¯é½¿æ•ˆæœ
   - ğŸ†• æ¤’ç›å™ªå£° (`saltpepper`) - ç°å°˜ç‚¹æ¨¡æ‹Ÿ
   - ğŸ†• å¤šé‡ç»„åˆé€€åŒ– (`composite`) - 2-3ç§æ•ˆæœæ™ºèƒ½ç»„åˆ
   - âœ… æ‰¹é‡å¤„ç†åŠŸèƒ½

3. **DatasetBuilder** (`src/data/dataset_builder.py`)
   - âœ… æ•°æ®é›†ç»“æ„åˆ›å»º
   - âœ… è®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†åˆ’åˆ†
   - âœ… æ•°æ®ç»Ÿè®¡å’ŒéªŒè¯

### æµ‹è¯•å’ŒéªŒè¯

- **test_clean_chart.py**: å•ä¸€æ¸…æ™°å›¾è¡¨ç”Ÿæˆæµ‹è¯• âœ…
- **test_data_generation.py**: å®Œæ•´æ•°æ®ç”Ÿæˆç®¡é“æµ‹è¯• âœ…
- **generate_large_dataset.py**: å¤§è§„æ¨¡æ•°æ®é›†ç”Ÿæˆè„šæœ¬ âœ…
- **quick_demo.py**: å¿«é€Ÿæ¼”ç¤ºè„šæœ¬ âœ…

## ç”Ÿæˆçš„æ•°æ®ç¤ºä¾‹

### æµ‹è¯•æ•°æ®ç»“æ„
```
test_data/
â”œâ”€â”€ dataset/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ clean/ (1ä¸ªæ–‡ä»¶)
â”‚   â”‚   â””â”€â”€ blur/ (3ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ val/
â”‚   â”‚   â”œâ”€â”€ clean/ (0ä¸ªæ–‡ä»¶)
â”‚   â”‚   â””â”€â”€ blur/ (0ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ clean/ (2ä¸ªæ–‡ä»¶)
â”‚       â””â”€â”€ blur/ (6ä¸ªæ–‡ä»¶)
â”œâ”€â”€ clean_charts/ (3ä¸ªPNGæ–‡ä»¶)
â”œâ”€â”€ blur_charts/ (9ä¸ªPNGæ–‡ä»¶)
â””â”€â”€ csv_samples/ (3ä¸ªCSVæ–‡ä»¶)
```

### æ•°æ®é›†ç»Ÿè®¡
- **æ€»æ¸…æ™°å›¾åƒ**: 3
- **æ€»æ¨¡ç³Šå›¾åƒ**: 9
- **åˆ’åˆ†æ¯”ä¾‹**: 60%è®­ç»ƒ, 20%éªŒè¯, 20%æµ‹è¯•

## æ¨¡ç³Šç±»å‹å®ç°

### åŸºç¡€æ¨¡ç³Šæ•ˆæœ
1. **é«˜æ–¯æ¨¡ç³Š** (`gaussian`) - ä½¿ç”¨cv2.GaussianBlur
2. **è¿åŠ¨æ¨¡ç³Š** (`motion`) - è‡ªå®šä¹‰è¿åŠ¨æ ¸+æ—‹è½¬
3. **å‹ç¼©ä¼ªå½±** (`compression`) - JPEGå‹ç¼©è´¨é‡æ§åˆ¶
4. **æ‰“å°æ‰«æ** (`scan`) - å‡ ä½•å˜æ¢+å™ªå£°+äº®åº¦å¯¹æ¯”åº¦
5. **ä½åˆ†è¾¨ç‡** (`lowres`) - é™é‡‡æ ·+å‡é‡‡æ ·
6. **æ–‡æœ¬å¹²æ‰°** (`text`) - éšæœºå­—æ¯æ•°å­—å åŠ 
7. **çº¿æ¡å¹²æ‰°** (`lines`) - éšæœºç»†çº¿æ·»åŠ 

### æ–°å¢é«˜çº§æ¨¡ç³Šæ•ˆæœ âœ¨
8. **çº¿æ¡ç²—ç»†å˜åŒ–** (`morphology`) - cv2.erode/dilateæ¨¡æ‹Ÿç¬”ç”»å˜åŒ–
9. **å±€éƒ¨é€€åŒ–** (`localblur`) - éšæœºpatchå¼ºæ¨¡ç³Šï¼Œæ¨¡æ‹Ÿå±€éƒ¨ç³Šæ‰
10. **é˜ˆå€¼åŒ–ä¼ªå½±** (`threshold`) - äºŒå€¼åŒ–+æ¢å¤ï¼Œäº§ç”Ÿè¾¹ç¼˜é”¯é½¿
11. **æ¤’ç›å™ªå£°** (`saltpepper`) - éšæœºé»‘ç™½ç‚¹ï¼Œæ¨¡æ‹Ÿç°å°˜
12. **å¤šé‡ç»„åˆé€€åŒ–** (`composite`) - 2-3ç§æ•ˆæœéšæœºç»„åˆ

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿæµ‹è¯•
```bash
# åŸºç¡€åŠŸèƒ½æµ‹è¯•
python test_data_generation.py

# å¿«é€Ÿæ¼”ç¤º
python quick_demo.py
```

### å¤§è§„æ¨¡æ•°æ®ç”Ÿæˆ
```bash
# ç”Ÿæˆ100ä¸ªæ ·æœ¬çš„æ•°æ®é›†
python generate_large_dataset.py
```

### è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆ
```python
from src.data.clean_chart_generator import CleanChartGenerator
from src.data.blur_generator_simple import SimpleBlurGenerator

# ç”Ÿæˆæ¸…æ™°å›¾è¡¨
generator = CleanChartGenerator()
generator.process_csv_to_chart('input.csv', 'output.png')

# ç”Ÿæˆæ¨¡ç³Šå˜ä½“
blur_gen = SimpleBlurGenerator()
result = blur_gen.apply_random_blur(image)
```

## ä¸‹ä¸€æ­¥

æ•°æ®ç”ŸæˆåŠŸèƒ½å·²å®Œæˆï¼Œå¯ä»¥è¿›è¡Œï¼š

1. **åˆ‡æ¢åˆ°æœ‰å¡æ¨¡å¼** - å®‰è£…PyTorchç­‰æ·±åº¦å­¦ä¹ ä¾èµ–
2. **Baselineæ¨¡å‹è®­ç»ƒ** - U-Netå»æ¨¡ç³Šç½‘ç»œ
3. **æ‰©æ•£æ¨¡å‹è®­ç»ƒ** - æ¡ä»¶æ‰©æ•£æ¨¡å‹å®ç°

## æŠ€æœ¯è¯´æ˜

- ä½¿ç”¨çº¯NumPyå®ç°ï¼Œé¿å…äº†OpenCVä¾èµ–
- matplotlibä½¿ç”¨Aggåç«¯ï¼Œæ”¯æŒæ— ç•Œé¢ç¯å¢ƒ
- PILç”¨äºå›¾åƒä¿å­˜å’ŒåŠ è½½
- æ”¯æŒæ‰¹é‡å¤„ç†å’Œè‡ªåŠ¨åŒ–æ•°æ®é›†æ„å»º

**æ•°æ®ç”Ÿæˆç®¡é“å·²å°±ç»ªï¼Œå¯ä»¥å¼€å§‹æ¨¡å‹è®­ç»ƒï¼** ğŸš€